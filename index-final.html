<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Roulette PayPal</title>
  <script src="https://cdn.jsdelivr.net/gh/zarocknz/javascript-winwheel@master/Winwheel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://www.paypal.com/sdk/js?client-id=sb&currency=EUR"></script>
  <style>
    body {
      text-align: center;
      font-family: Arial, sans-serif;
      margin-top: 30px;
    }
    canvas {
      display: block;
      margin: 0 auto;
    }
    #spinBtn {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 18px;
    }
    #paypal-button-container {
      margin-top: 20px;
      display: none;
    }
  </style>
</head>
<body>

<h1>üé∞ Lancer la Roulette !</h1>
<canvas id="rouletteCanvas" width="500" height="500"></canvas>
<button id="spinBtn">Lancer la roulette</button>
<div id="paypal-button-container"></div>

<script>
  window.onload = function () {
    let selectedAmount = 0;

    let theWheel = new Winwheel({
      canvasId: 'rouletteCanvas',
      numSegments: 6,
      segments: [
        { fillStyle: '#eae56f', text: 'Bonjour' },
        { fillStyle: '#89f26e', text: 'Tu as gagn√© 2 ‚Ç¨' },
        { fillStyle: '#7de6ef', text: 'Perdu' },
        { fillStyle: '#e7706f', text: 'Tu as gagn√© 5 ‚Ç¨' },
        { fillStyle: '#f0a', text: 'Essaie encore' },
        { fillStyle: '#6e6ef2', text: 'Tu as gagn√© 10 ‚Ç¨' }
      ],
      animation: {
        type: 'spinToStop',
        duration: 5,
        spins: 6,
        callbackFinished: handleResult
      }
    });

    document.getElementById('spinBtn').addEventListener('click', function () {
      document.getElementById("paypal-button-container").style.display = "none";
      theWheel.stopAnimation(false);
      theWheel.rotationAngle = 0;
      theWheel.draw();
      theWheel.startAnimation();
    });

    function handleResult(segment) {
      alert("R√©sultat : " + segment.text);
      if (segment.text.includes("2 ‚Ç¨")) {
        selectedAmount = 2;
        showPayPal();
      } else if (segment.text.includes("5 ‚Ç¨")) {
        selectedAmount = 5;
        showPayPal();
      } else if (segment.text.includes("10 ‚Ç¨")) {
        selectedAmount = 10;
        showPayPal();
      }
    }

    function showPayPal() {
      const container = document.getElementById("paypal-button-container");
      container.style.display = "block";
      container.innerHTML = "";
      paypal.Buttons({
        createOrder: function(data, actions) {
          return actions.order.create({
            purchase_units: [{
              amount: {
                value: selectedAmount.toString()
              }
            }]
          });
        },
        onApprove: function(data, actions) {
          return actions.order.capture().then(function(details) {
            alert("Merci " + details.payer.name.given_name + "! Paiement de " + selectedAmount + " ‚Ç¨ re√ßu.");
          });
        }
      }).render('#paypal-button-container');
    }
  }
</script>

</body>
</html>
